# 系统API

- **注册：**

  触发方式：用户点击

  触发结果：添加用户

  ```
  API:http:127.0.0.1:8000/v1/customers
  ```

  请求方式：post

  请求格式：json

  请求数据：

  | 字段      | 含义     | 类型       | 备注 |
  | --------- | -------- | ---------- | ---- |
  | phone     | 手机号   | 11位数字   |      |
  | name      | 用户名   | 11位字符串 |      |
  | password1 | 密码     |            |      |
  | password2 | 确认密码 |            |      |
  | sex       | 性别     |            |      |
  | vecode    | 验证码   | 6位数字    |      |

  响应格式：json

  响应数据：

  | 字段 | 含义   | 类型 | 备注 |
  | ---- | ------ | ---- | ---- |
  | code | 响应码 | int  |      |

  响应码：

  | code  | 含义       | 备注 |
  | ----- | ---------- | ---- |
  | 200   | 成功       |      |
  | 10101 | 验证码错误 |      |
  | 101×× |            |      |

  

- **登录：**

  触发方式：用户点击

  触发结果：设置token

  ```
  API:http:127.0.0.1:8000/v1/tokens
  ```

  请求方式：post
  请求格式：json

  请求数据：

  | 字段     | 含义   | 类型     | 备注 |
  | -------- | ------ | -------- | ---- |
  | phone    | 手机号 | 11位数字 |      |
  | password | 密码   | char     |      |

  响应格式：json

  响应数据：

  | 字段  | 含义     | 类型   | 备注 |
  | ----- | -------- | ------ | ---- |
  | code  | 响应码   | int    |      |
  | token | 用户数据 | 字符串 |      |

  响应码：

  | code  | 含义             | 备注 |
  | ----- | ---------------- | ---- |
  | 200   | 成功             |      |
  | 10201 | 用户名或密码错误 |      |
  | 102×× |                  |      |

  

- **首页推荐菜品：**

  触发方式：用户登录成功后

  触发结果：返回推荐菜品数据

  ```
  API:http:127.0.0.1:8000/v1/messages/greens
  ```

  请求方式：get
  请求格式：json

  请求数据：无

  响应格式：json

  响应数据：

  | 字段          | 含义     | 类型 | 备注 |
  | ------------- | -------- | ---- | ---- |
  | code          | 响应码   | int  |      |
  | green_number  | 菜品编号 | int  |      |
  | green_name    | 菜品名   | char |      |
  | green_price   | 菜品单价 | int  |      |
  | green_picture | 菜品图片 | char |      |

  响应码：

  | code  | 含义         | 备注             |
  | ----- | ------------ | ---------------- |
  | 200   | 成功         |                  |
  | 10301 | 获取数据异常 | 针对与服务器出错 |
  | 103×× |              |                  |

- **根据分类查看菜品：**

  触发方式：用户点击

  触发结果：返回相关分类菜品数据给用户

  ```
  API:http:127.0.0.1:8000/v1/messages/greens/<greensID>
  ```

  请求方式：get
  请求格式：json

  请求数据：

  | 字段     | 含义       | 类型 | 备注                       |
  | -------- | ---------- | ---- | -------------------------- |
  | greensID | 菜品类别ID | int  | 该ID存储在相应的按钮的ID里 |

  响应格式：json

  响应数据：

  | 字段          | 含义     | 类型 | 备注 |
  | ------------- | -------- | ---- | ---- |
  | code          | 响应码   | int  |      |
  | green_number  | 菜品编号 | int  |      |
  | green_name    | 菜品名   | char |      |
  | green_price   | 菜品单价 | int  |      |
  | green_picture | 菜品图片 | char |      |

  响应码：

  | code  | 含义         | 备注 |
  | ----- | ------------ | ---- |
  | 200   | 成功         |      |
  | 10401 | 获取数据异常 |      |
  | 104×× |              |      |

- **点菜：**

  触发方式：用户点击

  触发结果：购物车加入相应菜品或菜品数加一

  ```
  API：http:127.0.0.1:8000/v1/messages/shoppingcart
  ```

  请求方式：post
  请求格式：json

  请求数据：

  | 字段         | 含义     | 类型     | 备注         |
  | ------------ | -------- | -------- | ------------ |
  | phone        | 手机号   | 11位数字 | 将作为订单ID |
  | green_number | 菜品编号 | int      | 从按钮中取   |
  |              |          |          |              |

  响应格式：json

  响应数据：

  | 字段 | 含义   | 类型 | 备注 |
  | ---- | ------ | ---- | ---- |
  | code | 响应码 | int  |      |

  响应码：

  | code  | 含义                 | 备注 |
  | ----- | -------------------- | ---- |
  | 200   | 成功                 |      |
  | 10501 | 用户未登录或登录过时 |      |
  | 10502 | 菜品数据不存在       |      |
  | 10503 | 添加错误             |      |
  | 105×× |                      |      |

- **查看购物车：**

  触发方式：用户点击

  触发结果：返回购物车数据

  ```
  API:http:127.0.0.1:8000/v1/messages/shoppingcart
  ```

  请求方式：get
  请求格式：json

  请求数据：

  | 字段  | 含义   | 类型     | 备注       |
  | ----- | ------ | -------- | ---------- |
  | phone | 手机号 | 11位数字 | 从内存中拿 |
  |       |        |          |            |

  响应格式：json

  响应数据：

  | 字段          | 含义     | 类型    | 备注 |
  | ------------- | -------- | ------- | ---- |
  | code          | 响应码   | int     |      |
  | green_number  | 菜品编号 | int     |      |
  | green_name    | 菜品名   | varchar |      |
  | green_picture | 菜品图片 | image   |      |
  | number        | 菜品数量 | int     |      |

  响应码：

  | code  | 含义       | 备注 |
  | ----- | ---------- | ---- |
  | 200   | 成功       |      |
  | 10601 | 用户未登录 |      |
  | 10602 | 数据不存在 |      |
  | 106×× |            |      |

- **提交订单：**

  触发方式：用户点击

  触发结果：生成订单，返回订单号

  ```
  API:http:127.0.0.1:8000/v1/messages/orders
  ```

  请求方式：post
  请求格式：json

  请求数据：

  | 字段          | 含义         | 类型     | 备注 |
  | ------------- | ------------ | -------- | ---- |
  | green_numbers | 菜品字段数组 | int      |      |
  | number        | 数量         | int      |      |
  | take_time     | 订单生效时间 | datetime |      |

  响应格式：json

  响应数据：

  | 字段         | 含义   | 类型 | 备注 |
  | ------------ | ------ | ---- | ---- |
  | code         | 响应码 | int  |      |
  | order_number | 订单号 | int  |      |
  |              |        |      |      |

  响应码：

  | code  | 含义         | 备注 |
  | ----- | ------------ | ---- |
  | 200   | 成功         |      |
  | 10701 | 用户登录过期 |      |
  | 10702 | 提交失败     |      |
  | 107×× |              |      |

  

- **查看订单：**

  触发方式：用户点击

  触发结果：返回订单数据

  ```
  API:http:127.0.0.1:8000/v1/messages/orders
  ```

  请求方式：get
  请求格式：json

  请求数据：

  | 字段  | 含义   | 类型     | 备注                           |
  | ----- | ------ | -------- | ------------------------------ |
  | phone | 手机号 | 11位数字 | 用于校验用户登录状态和查询订单 |
  |       |        |          |                                |

  响应格式：json

  响应数据：

  | 字段         | 含义         | 类型     | 备注 |
  | ------------ | ------------ | -------- | ---- |
  | code         | 响应码       | int      |      |
  | order_number | 订单编号     | int      |      |
  | order_type   | 订单类型     | varchar  |      |
  | create_time  | 下单时间     | datetime |      |
  | take_time    | 订单生效时间 | datetime |      |
  | order_price  | 订单总价     | int      |      |
  | order_state  | 订单状态     | varchar  |      |
  |              |              |          |      |

  响应码：

  | code  | 含义         | 备注 |
  | ----- | ------------ | ---- |
  | 200   | 成功         |      |
  | 10801 | 订单不存在   |      |
  | 10802 | 用户登录超时 |      |
  | 108×× |              |      |

  

- **取消订单：**

  触发方式：用户点击

  触发结果：删除订单

  ```
  API:http:127.0.0.1:8000/v1/messages/orders
  ```

  请求方式：delete
  请求格式：json

  请求数据：

  | 字段         | 含义       | 类型     | 备注 |
  | ------------ | ---------- | -------- | ---- |
  | phone        | 用户手机号 | 11位数字 |      |
  | order_number | 订单编号   | int      |      |
  |              |            |          |      |

  响应格式：json

  响应数据：

  | 字段 | 含义   | 类型 | 备注 |
  | ---- | ------ | ---- | ---- |
  | code | 响应码 | int  |      |

  响应码：

  | code  | 含义         | 备注 |
  | ----- | ------------ | ---- |
  | 200   | 删除成功     |      |
  | 10901 | 用户登录过期 |      |
  | 10902 | 订单不存在   |      |
  | 109×× |              |      |

  

- **修改订单：**

  触发方式：用户点击
  
  触发结果：修改订单信息

  ```
  API:http:127.0.0.1:8000/v1/messages/orders
  ```
  
  请求方式：put
  请求格式：json
  
  请求数据：
  
  | 字段         | 含义       | 类型     | 备注 |
  | ------------ | ---------- | -------- | ---- |
  | phone        | 用户手机号 | 11位数字 |      |
  | order_number | 订单编号   | int      |      |
  |              |            |          |      |
  
  响应格式：json
  
  响应数据：
  
  | 字段 | 含义   | 类型 | 备注 |
  | ---- | ------ | ---- | ---- |
  | code | 响应码 | int  |      |
  
  响应码：
  
  | code  | 含义         | 备注 |
  | ----- | ------------ | ---- |
  | 200   | 修改成功     |      |
  | 11001 | 用户登录过期 |      |
  | 11002 | 订单不存在   |      |
  | 110×× |              |      |